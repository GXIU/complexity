[TOC]

### MLE kennels

#### SMH

每次随机选取一个结点，随机赋予它一个角度。这个变化accepted的条件是，似然函数$\mathcal L_{new}>\mathcal L_{old}$; 否则，它是以$\frac{\mathcal L_{new}}{\mathcal L_{old}}$的概率get accepted. 

这种算法从角度的相空间里取样，并产生角结构。

- 计算复杂度：结点的改变次数收敛于$O(n^2)$（这个的原因文章里没有写）
  - 每次计算包括$O(n)$次似然比的比较。
  - 所以总共是$O(n^3)$

#### LMH

局部MH算法并不是MH算法本身。

如果样本的取样比较接近，LMH在极值优化和基因查找算法方面比传统的MH算法有着更好的适应性。

- 定义：结点$i$对$\ln \mathcal L$的局部贡献$\ln \mathcal L_i$ 
  $$
  \ln \mathcal L_i=\sum_{j\ne i}\{a_{ij} \ln p(\chi_{ij})+(1-a_{ij})\ln[1-p(\chi_{ij})]\}
  $$
  也就是$\ln \mathcal L =\frac{1}{2}\sum_i\ln\mathcal L_i$

  

这个$\ln\mathcal L_i$可以看作结点$i$的合适程度。我们可以通过逐渐优化来使得整体的似然函数最大。特别的，结点会被循环往复地访问。每次访问，结点都会被移动到一个位置，使得在固定其他结点位置的前提下，它的**合适程度**达到最大。使得算法达到收敛的总访问次数与网络平均度同阶。事实上，尽管在每次移动后，结点的合适程度会改比那，结点的合适程度还是会更多的被其*邻居*的角参数改变而改变。这也就决定了移动次数。（？）这种合适程度的最大化方法要$O(n^2)$的计算复杂度。每次取$\Delta \theta=\frac{1}{N}$作为取样间隔，所以总共的复杂度大概是$O(N^3).$



正式的，我们令$k_1>k_2>\cdots>k_m$为一系列预先确定的度，$G(k_i)$为度$\geq k_i$的结点以及他们之间的连边组成的图。我们有$G(k_1)\sub G(k_2)\sub\cdots\sub G(k_m)$，形成一个“图流”。我们的idea是，从最小的图开始，每次通过MLE方法，确定角参数；在每一次加上下一次的结点，直到最后。



问题：

- 第一个子图比较特殊：在无标度网络中，度超过$\sqrt N$的结点几乎必然相互连接。所以在最大似然的意义下，这些结点都一样。也就是会被安插在相同的位置。这不好。我们的解决办法是：去除大于$k_1～\sqrt N$的点之间的连接，也就是从$G(k_2)$开始迭代。

- 从$G(k_i)$到$G(k_{i+1})$，我们需要明确新增加点的初始角度。虽然随机赋值是可行的，但是一开始就应用最大似然法显然是更有运算效率的办法。也就是说，对于每个新加入的结点$i$一个角度，使得适应程度$\ln\mathcal L_i[G(k_l)]$达到最大值。
  $$
  \ln\mathcal L_i[G(k_l)]=\sum_{j\in G(k_l)}a_{ij} \{\ln p(\chi_{ij})+(1-a_ij)\ln[1-p(\chi_{ij})]\}
  $$
  这种方法确保了在上一个图给定信息的意义下，结点$i$确定的初始位置是最优的。

- 在所有结点都加入系统之后，依照下面的算法，相继调整结点位置：

  1. 激活$G(k_1)$中的结点
  2. 给每个结点一个随机角度
  3. 去除它们内部的连边
  4. 对于$k_2$到$k_m$，
     1. 对于度相同的这些结点，将没有被激活的结点标记为$i$
     2. 如果与上一个图中的结点的连接数$\geq 2$
        1. 激活结点$i$
        2. 给它一个角度：$\arg\max_\theta \ln\mathcal L_i[G(k_{l-1})]$
     3. 对激活的结点运行MLE算法。



我们没必要考虑整个图来推断被连接最多的结点的角参数。我们现在使用这个点来加速我们的映射算法。特别的，我们使用第一个MLE直到子图长到一个特定的大小。然后其他的结点使用下面算法：

- 算法2
  1. 激活$G(k_1)$的结点，每个结点给一个随机角度；
  2. 去除它们内部的连边
  3. 确定一个最大层数$l_{临界}$
  4. 从第二层开始，
     1. 对于每个未激活的结点，如果它与上一层的连接多于2个，就激活它，并给它一个角度$\arg\max_\theta \ln\mathcal L_i[G(k_{l-1})]$
     2. 如果$l\le l_{临界}$ ，那么就对激活的结点运行MLE